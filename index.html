<html>
<head>
<style>
body
{
    margin: 0;
    width: 100%;
    height: 100%;
}
#main
{
    width: 100%;
    height: 100%;
    background-color: black;
    background-image: url(img/main.png);
    background-repeat: no-repeat;
    background-size: 100% 100%;
    position: absolute;
}
#hardModeButton
{
    background-repeat: no-repeat;
    background-size: contain;
    width: 20.2%;
    height: 6.7%;
    position: absolute;
    top: 84%;
    left: 71%;
    cursor: pointer;
    background-size: 100% 100%;
}
.hardOn
{
    background-image: url(img/hard_mode_on.png);
}
.hardOff
{
    background-image: url(img/hard_mode_off.png);

}
#lootFrame
{
    z-index: 2;
    top: 57%;
    left: 6.75%;
    width: 27.35%;
    height: 26.3%;
    background-image: url(img/loot_frame.png);
    background-repeat: no-repeat;
    background-size: 100% 100%;
    position: absolute;
    cursor: pointer;
    overflow: hidden;
}
#lootPic
{
    z-index: 0;
    top: 57.1%;
    left: 7.1%;
    width: 26.75%;
    height: 25.7%;
    background-repeat: no-repeat;
    background-size: 100% 100%;
    position: absolute;
}
#lootName
{
    top: 83%;
    left: 7%;
    width: 26.7%;
    height: 6.2%;
    text-align: center;
    display: block;
    color: transparent;
    text-shadow: 0 0 1.5px rgb(228 89 88);
    font-size: 3.2vh;
    position: absolute;
    line-height: 200%;
    user-select: none;
}
#lootSelector
{
    top: 10%;
    left: 3.5%;
    width: 95%;
    height: 95%;
    position: absolute;
    overflow: visible;
    margin: 0;
    padding: 0;
}
#lootSelector:hover .lootObject
{
    z-index: 0;
    width: 15%;
    transition: width 0.05s linear, background-size 0.05s linear;
}
#lootSelector:hover .lootObject:last-child
{
    z-index: 1 !important;
    width: 65% !important;
    transform: perspective(0) rotateY(0deg);
}
.lootTequilla { background-image: url(img/primary_loot/tequilla.png); }
.lootNecklace { background-image: url(img/primary_loot/necklace.png); }
.lootBonds { background-image: url(img/primary_loot/bonds.png); }
.lootDiamond { background-image: url(img/primary_loot/diamond.png); }
.lootPanther { background-image: url(img/primary_loot/panther.png); }
.lootFiles { background-image: url(img/primary_loot/files.png); }
.lootObject
{
    z-index: 0;
    transform: perspective(500px) rotateY(35deg);
    width: 24%;
    height: 81%;
    background-repeat: no-repeat;
    background-position: 40% 50%;
    background-size: 200% 200%;
    border: 0.55vw solid #f0eeef9c;
    border-radius: 2px;
    display: inline-block;
    margin-right: -15%;
    cursor: pointer;
    margin-bottom: 3%;
}
.lootObject:hover
{
    z-index: 1 !important;
    border-color: #f0ec809c !important;
    width: 65% !important;
    background-size: 100% 100%;
    /* height: 65%; */
    transform: perspective(0) rotateY(0deg);
}
.hidden
{
    display: none;
}

#primaryName
{
    position: absolute;
    width: 14.7%;
    height: 4%;
    top: 8.3%;
    right: 7.8%;
    text-align: center;
    color: transparent;
    text-shadow: 0 0 1.5px #411c1be6;
    font-size: 1.4vw;
    line-height: 3.4vh;
    font-variant: all-small-caps;
    font-family: system-ui;
}
#primaryValue
{
    position: absolute;
    width: 14.7%;
    height: 4.9%;
    top: 12.2%;
    right: 7.8%;
    text-align: center;
    color: transparent;
    text-shadow: 0 0 1.5px #ffffffab;
    font-size: 1.4vw;
    line-height: 4.5vh;
    font-variant: all-small-caps;
    font-family: system-ui;
    user-select: none;
}
#setupContainer
{
    position: absolute;
    width: 26.5%;
    height: 45%;
    top: 10%;
    left: 7.5%;
    border: 0px solid #ffffffab;
}
.setupCategory
{
    height: 10%;
    background-image: url(img/element.png);
    background-size: 100% 110%;
    padding-left: 0.5vw;
    cursor: pointer;
    color: transparent;
    text-shadow: 0 0 1.5px #ffffffab;
    padding-top: 0px;
    /* vertical-align: middle; */
    margin-bottom: 1%;
    position: relative;
}
.setupCategory:hover
{
    background-color: #ffffffab;
    text-shadow: 0 0 1.5px #000;
    transition: background-color 0.5s linear;
}
.setupCategory span
{
    color: inherit;
    text-shadow: inherit;
    padding-left: 1.8vw;
    font-size: 1.4vw;
    line-height: 4vh;
    font-variant: all-small-caps;
    font-family: system-ui;
    user-select: none;
    pointer-events: none;
}
.backButton
{
    cursor: pointer;
    color: transparent;
    text-shadow: 0 0 1.5px #ffffffab;
    height: 10%;
    font-size: 1.4vw;
    line-height: 4vh;
    font-variant: all-small-caps;
    font-family: system-ui;
}
.checkbox
{
    width: 6%;
    height: 60%;
    position: absolute;
    top: 20%;
    display: inline-flex;
    margin: 0;
    line-height: 4vh;
}
.checked
{
    background-image: url(img/checked.png);
    background-size: 100% 100%;
}
.teamSize
{
    text-align: center;
}
.playerCut, .teamSize
{
    background-color: transparent;
    outline: none;
    border: 0px;
    color: #827d7d;
    font-size: 2.2vh;
    width: 6vh;
    right: 5%;
    position: absolute;
    top: 25%;
    border-radius: 25%;
}
.setupCategory:hover .playerCut, .setupCategory:hover .teamSize
{
    color: black;
}
.moneyLimitLabel
{
    position: absolute;
    width: 14.7%;
    height: 4%;
    text-align: center;
    color: transparent;
    text-shadow: 0 0 1.5px #411c1be6;
    font-size: 1.4vw;
    line-height: 3.4vh;
    font-variant: all-small-caps;
    font-family: system-ui;
}
.moneyLimit
{
    position: absolute;
    width: 14.7%;
    height: 4%;
    text-align: center;
    color: transparent;
    text-shadow: 0 0 1.5px #f0eeef9c;
    font-size: 1.4vw;
    line-height: 3.4vh;
    font-variant: all-small-caps;
    font-family: system-ui;
    background-color: transparent;
    border: 0px;
    outline: none;
    caret-color: #f0eeef9c;
}
#cutLimitLabel
{
    top: 31.2%;
    right: 7.95%;
}
#cutLimit
{
    top: 35.4%;
    right: 7.95%;
}
#takeLimitLabel
{
    top: 19.8%;
    right: 7.9%;
}
#takeLimit
{
    top: 24%;
    right: 7.95%;
}
.error
{
    animation: errorFont 1s infinite;
}
@keyframes errorFont
{
  0% { text-shadow: 0 0 1.5px #f0eeef9c; }
  50% { text-shadow: 0 0 1.5px #411c1be6; }
  100% { text-shadow: 0 0 1.5px #f0eeef9c; }
}
.truckIcon
{
    background-image: url(img/truck_off.png);
    background-size: 100% 100%;
    width: 1.4%;
    height: 3%;
    position: absolute;
    cursor: pointer;
}
.truckOn
{
    background-image: url(img/truck_on.png);
}
#truck1
{
    top: 21.4%;
    left: 56.4%;
}
#truck2
{
    top: 23.4%;
    left: 70.7%;
}
#truck3
{
    top: 43.8%;
    left: 70.3%;
}
#truck4
{
    top: 47.2%;
    left: 66.3%;
}
#truck5
{
    top: 68.7%;
    left: 66.5%;
}
</style>
</head>
<body>

    <!-- PAGE BACKGROUND -->
    <div id="main"></div>

    <!-- SETUP -->
    <div id="setupContainer">
        <div id="setupCategories">
            <div id="approachVehiclesCategory" class="setupCategory"><div class="checkbox"></div><span>Approach Vehicles</span></div>
            <div id="weaponCategory" class="setupCategory"><div class="checkbox"></div><span>Weapons</span></div>
            <div id="disruptionCategory" class="setupCategory"><div class="checkbox"></div><span>Disruption</span></div>
            <div id="takeCategory" class="setupCategory"><div class="checkbox"></div><span>Player Take Calculator</span></div>
        </div>
        <div id="approachVehiclesContainer" class="setupCategoryContainer hidden">
            <div class="backButton"> &lt; Approach Vehicles</div>
            <div id="vehicleKosatka" class="setupCategory" bin="1"><div class="checkbox"></div><span>Submarine: Kosatka</span></div>
            <div id="vehicleAlkonost" class="setupCategory" bin="2"><div class="checkbox"></div><span>Plane: Alkonost</span></div>
            <div id="vehicleVelum" class="setupCategory" bin="4"><div class="checkbox"></div><span>Plane: Velum</span></div>
            <div id="vehicleAnnihilator" class="setupCategory" bin="8"><div class="checkbox"></div><span>Helicopter: Stealth Annihilator</span></div>
            <div id="vehiclePatrolBoat" class="setupCategory" bin="16"><div class="checkbox"></div><span>Boat: Patrol Boat</span></div>
            <div id="vehicleLongfin" class="setupCategory" bin="32"><div class="checkbox"></div><span>Boat: Longfin</span></div>
        </div>
        <div id="weaponContainer" class="setupCategoryContainer hidden">
            <div class="backButton"> &lt; Weapons</div>
            <div id="weaponAggressor" class="setupCategory" int="1"><div class="checkbox"></div><span>Aggressor</span></div>
            <div id="weaponConspirator" class="setupCategory" int="2"><div class="checkbox"></div><span>Conspirator</span></div>
            <div id="weaponCrackshot" class="setupCategory" int="3"><div class="checkbox"></div><span>Crackshot</span></div>
            <div id="weaponSaboteur" class="setupCategory" int="4"><div class="checkbox"></div><span>Saboteur</span></div>
            <div id="weaponMarksman" class="setupCategory" int="5"><div class="checkbox"></div><span>Marksman</span></div>
            <!-- <div id="weaponSuppressors" class="setupCategory"><div class="checkbox checked"></div><span>Suppressors</span></div> -->
        </div>
        <div id="disruptionContainer" class="setupCategoryContainer hidden">
            <div class="backButton"> &lt; Disruption</div>
            <div id="disruptionWeapons" class="setupCategory"><div class="checkbox"></div><span>Weapons</span></div>
            <div id="disruptionArmor" class="setupCategory"><div class="checkbox"></div><span>Armor</span></div>
            <div id="disruptionAirSupport" class="setupCategory"><div class="checkbox"></div><span>Air Support</span></div>
        </div>
        <div id="takeContainer" class="setupCategoryContainer hidden">
            <div class="backButton"> &lt; Player Take Calculator</div>
            <div id="teamsize" class="setupCategory"><span>Team Size</span><input class="teamSize" type="number" value="1" min="1" max="4"></div>
            <div id="playerHost" class="setupCategory playerTake"><span>Host</span><input class="playerCut" playerid="1" type="number" value="100" min="15" max="100" step="5"></div>
            <div id="player2" class="setupCategory playerTake hidden"><span>Player 2</span><input class="playerCut" playerid="2" type="number" value="15" min="15" max="100" step="5"></div>
            <div id="player3" class="setupCategory playerTake hidden"><span>Player 3</span><input class="playerCut" playerid="3" type="number" value="15" min="15" max="100" step="5"></div>
            <div id="player4" class="setupCategory playerTake hidden"><span>Player 4</span><input class="playerCut" playerid="4" type="number" value="15" min="15" max="100" step="5"></div>
        </div>
    </div>


    <!-- PRIMARY LOOT SELECTOR -->
    <div id="lootFrame">
        <div id="lootSelector" class="hidden">
            <div class="lootObject lootTequilla" title="Sinsimito Tequilla"></div>
            <div class="lootObject lootNecklace" title="Ruby Necklace"></div>
            <div class="lootObject lootBonds" title="Bearer Bonds"></div>
            <div class="lootObject lootDiamond" title="Pink Diamond"></div>
            <div class="lootObject lootPanther" title="Panther Statue"></div>
            <div class="lootObject lootFiles" title="Minimadrazzo Files"></div>
        </div>
    </div>

    <!-- PRIMARY LOOT SELECTED -->
    <div id="lootPic"></div>
    <div id="lootName"></div>
    <div id="primaryName"></div>
    <div id="primaryValue"></div>

    <!-- TOTAL TAKE LIMIT -->
    <div id="takeLimitLabel" class="moneyLimitLabel">Total Take Limit</div>
    <input id="takeLimit" type="text" class="moneyLimit"></div>

    <!-- CUT LIMIT -->
    <div id="cutLimitLabel" class="moneyLimitLabel">Cut Limit</div>
    <input id="cutLimit" type="text" class="moneyLimit"></div>

    <div id="truck1" class="truckIcon"></div>
    <div id="truck2" class="truckIcon"></div>
    <div id="truck3" class="truckIcon"></div>
    <div id="truck4" class="truckIcon"></div>
    <div id="truck5" class="truckIcon"></div>

    <div id="playerCutContainer">

    </div>

    <!-- HARD MODE INDICATOR -->
    <div id="hardModeButton" class="hardOff"></div>
</body>
<script>
/* CAYO PERICO HEIST SETUP DATA */
/* RESOURCES TO GENERATE STAT.TXT FROM */
let cayo =
{
    primary:
    {
        variable: "$MPx_H4CNF_TARGET",
        loot:
        [
            { name: "Minimadrazzo Files", price: 1000000, value: 4, className: "lootFiles" },
            { name: "Sinsimito Tequilla", price: 900000, value: 0, className: "lootTequilla" },
            { name: "Ruby Necklace", price: 1000000, value: 1, className: "lootNecklace" },
            { name: "Bearer Bonds", price: 1100000, value: 2, className: "lootBonds" },
            { name: "Pink Diamond", price: 1300000, value: 3, className: "lootDiamond" },
            { name: "Panther Statue", price: 1900000, value: 5, className: "lootPanther" }
        ]
    },
    secondary:
    [
        { name: "Cash", size: 0.25, variable: "CASH" },
        { name: "Painting",  size: 0.5, variable: "PAINT"},
        { name: "Weed",  size: 0.5, variable: "WEED" },
        { name: "Coke",  size: 0.5, variable: "COKE" },
        { name: "Gold",  size: 0.6666666, variable: "GOLD" }
    ],
    npcCutPercentage: 12,
    difficulty:
    {
        variable: "$MPx_H4_PROGRESS",
        normal: 124271,
        hard: 130415
    },
    hardModeMultiplier: 1.1,
    disruption:
    [
        { name: "Weapons", variable: "$MPx_H4CNF_WEP_DISRP", range: [0, 3] },
        { name: "Armor", variable: "$MPx_H4CNF_ARM_DISRP", range: [0, 3] },
        { name: "AirSupport", variable: "$MPx_H4CNF_HEL_DISRP", range: [0, 3] }
    ],
    defaultCutLimit: 2550000,
    defaultTakeLimit: 10818212
}

/* USER SET SETTINGS */
/* CREATE CURRENT STAT.TXT FROM THIS */
let settings =
{
    primary: 1, //cayo.primary.loot array id
    difficulty: "normal", //cayo.difficulty
    vehicleValue: 0,
    disruption: {}
};

/* FUNCTIONALITY */

/* TOGGLES HARD MODE ON DIV CLICK */
function toggleHardMode(event)
{
    let button = event.target;

    /* recognize button state to decide what difficulty to write
       and which price to use */
    let primaryValue = document.querySelector("#primaryValue");
    if (button.className == "hardOff")
    {
        button.className = "hardOn";
        settings.difficulty = "hard";
        if (Number.isInteger(settings.primary.price))
            primaryValue.textContent = (settings.primary.price * cayo.hardModeMultiplier).toLocaleString()
    }
    else
    {
        button.className = "hardOff";
        settings.difficulty = "normal";
        if (Number.isInteger(settings.primary.price))
            primaryValue.textContent = (settings.primary.price).toLocaleString()
    }

    calculateTake();
}
document.querySelector("#hardModeButton").addEventListener("click", toggleHardMode); //hard mode button click event

/* display loot selector */
function showLootSelector()
{
    document.querySelector("#lootSelector").classList.toggle("hidden");
}
document.querySelector("#lootFrame").addEventListener("click", showLootSelector); //loot selector button click event

/* select primary loot from selector */

function selectPrimaryLoot(lootName)
{
    /* find by name because i was too lazy to add indexes into html */
    cayo.primary.loot.forEach(function(loot)
    {
        if (loot.name == lootName)
            settings.primary = loot;
    });

    /* set loot display */
    document.querySelector("#lootPic").className = settings.primary.className;
    document.querySelector("#lootName").textContent = settings.primary.name;
    document.querySelector("#primaryName").textContent = settings.primary.name;
    document.querySelector("#primaryValue").textContent = (settings.difficulty == "normal") ? settings.primary.price.toLocaleString() : (settings.primary.price * cayo.hardModeMultiplier).toLocaleString();;

    calculateTake();
}
function selectPrimary(event)
{
    selectPrimaryLoot(event.target.title);
}
document.querySelectorAll(".lootObject").forEach(function(lootElement) //for each loot card add select function
{
    lootElement.addEventListener("click", selectPrimary);
});

// select tequilla by default
selectPrimaryLoot("Sinsimito Tequilla");

/* open category on click */
function expandSettingsContainer(event)
{
    document.querySelector("#setupCategories").className = "hidden";
    document.querySelector("#" + event.target.id.replace("Category", "Container")).classList.remove("hidden");
}
document.querySelectorAll("#setupCategories .setupCategory").forEach(function(setupCategory)
{
    setupCategory.addEventListener("click", expandSettingsContainer);
});

/* make escape key close, hide, cancel or go back */
function escapeKey(event)
{
    /* quit execution if non escape key is pressed */
    if (event.keyCode != 27)
        return;

    /* hide loot selector */
    let lootSelector = document.querySelector("#lootSelector");
    if (lootSelector.className != "hidden")
        lootSelector.className = "hidden";

    /* go back with heist settings*/
    let setupCategories = document.querySelector("#setupCategories");
    if (setupCategories.className == "hidden")
    {
        //find setupcategory which is not hidden
        document.querySelectorAll(".setupCategoryContainer").forEach(function(category)
        {
            if (!category.classList.contains("hidden"))
            {
                //hide that shit and restore categories visibilty
                category.classList.add("hidden");
                setupCategories.classList.remove("hidden");
            }
        });
    }
}
document.addEventListener("keydown", escapeKey); //set da event

/* back button function on click */
function goBack()
{
    document.querySelectorAll(".setupCategoryContainer").forEach(function(category)
    {
        if (!category.classList.contains("hidden"))
            category.classList.add("hidden");
    });

    document.querySelector("#setupCategories").classList.remove("hidden");
}
document.querySelectorAll(".backButton").forEach(function(button)
{
    button.addEventListener("click", goBack);
});

/* unlock vehicles */
function toggleVehicle(event)
{
    console.log(event.target);
    var checkbox = event.target.querySelector(".checkbox");
    if (checkbox.classList.contains("checked"))
    {
        checkbox.classList.remove("checked");
        settings.vehicleValue -= parseInt(event.target.getAttribute("bin"));
    }
    else
    {
        checkbox.classList.add("checked");
        settings.vehicleValue += parseInt(event.target.getAttribute("bin"));
    }

    console.log(settings.vehicleValue);
}
document.querySelectorAll("#approachVehiclesContainer .setupCategory").forEach(function(vehicleElement)
{
    vehicleElement.addEventListener("click", toggleVehicle);
});

/* unlock equipment */
//all on by default
//TODO maybe: customize

/* select weapon */
function selectWeapon(event)
{
    settings.weaponID = parseInt(event.target.getAttribute("int"));
    if (event.target.classList.contains("checked"))
    {
        event.target.querySelector(".checkbox").classList.remove("checked");
    }
    else
    {
        document.querySelectorAll("#weaponContainer .setupCategory").forEach(function(weapon)
        {
            weapon.querySelector(".checkbox").classList.remove("checked");
        });
        event.target.querySelector(".checkbox").classList.add("checked");
    }
}
document.querySelectorAll("#weaponContainer .setupCategory").forEach(function(weapon)
{
    weapon.addEventListener("click", selectWeapon);
});

/* mark disruptions */
function markDisruption(event)
{
    if (event.target.querySelector(".checkbox").classList.contains("checked"))
    {
        delete settings.disruption[event.target.id.replace("disruption", "")];
        event.target.querySelector(".checkbox").classList.remove("checked");
    }
    else
    {
        settings.disruption[event.target.id.replace("disruption", "")] = 3;
        event.target.querySelector(".checkbox").classList.add("checked");
    }
    console.log(settings.disruption);
}
document.querySelectorAll("#disruptionContainer .setupCategory").forEach(function(weapon)
{
    weapon.addEventListener("click", markDisruption);
});


/* calculate loot values */

/* reverses percentage from current value and known percentage */
function reversePercentage(value, percent)
{
    if (percent == 100)
        return value;

    return (value * 100) / (100 - percent);
}

function getLootSize(loot)
{
    let size;
    cayo.secondary.forEach(function(type)
    {
        if (type.name.toLowerCase() == loot)
            size = type.size;
    });

    return size;
}
function calculateGoldValue(bagLoad)
{
    settings.secondary.push({name: "Gold", value: Math.floor(bagLoad * getLootSize("gold"))});
}
function calculatePaintingValue(bagLoad)
{
    settings.secondary.push({name: "Painting", value: Math.floor(bagLoad * getLootSize("painting"))});
}

function calculateTopPlayerTake()
{
    //get top player take
    let topTakePlayerID = 0; //do i need this?
    let takeValue = 0;
    document.querySelectorAll("#takeContainer .setupCategory.playerTake:not(.hidden) input").forEach(function(input)
    {
        let percentageValue = parseInt(input.value);
        if (percentageValue > takeValue)
        {
            takeValue = percentageValue;
            topTakePlayerID = parseInt(input.getAttribute("playerid"));
        }
    });

    return takeValue;
}

function calculateTake()
{
    let topPlayerTake = calculateTopPlayerTake();

    //calculate full take based on highest percentage
    let fullTake = reversePercentage(settings.cutLimit || cayo.defaultCutLimit, 100 - topPlayerTake);
    //exceeding limits means no money is received
    if (fullTake > (settings.takeLimit || cayo.defaultTakeLimit))
        document.querySelector("#takeLimit").classList.add("error");
    else
        document.querySelector("#takeLimit").classList.remove("error");

    let score = Math.floor(reversePercentage(fullTake, cayo.npcCutPercentage));

    //brace for ugly
    let primaryPrice = Math.floor(settings.primary ? ( (settings.difficulty == "hard") ? (settings.primary.price * cayo.hardModeMultiplier) : settings.primary.price) : 0);
    //end ugly

    //pretty now again
    let primaryMinusPavel = Math.floor((primaryPrice * (100 - cayo.npcCutPercentage) * 0.01));
    let scoreMinusPrimary = Math.floor(score - primaryPrice);

    let playerCount = parseInt(document.querySelector("#teamsize .teamSize").value);
    let singleBagLoad = scoreMinusPrimary / playerCount;

    if (singleBagLoad) //might be undefined when no primary selected, we don't want 'undefined' in settings
    {
        if (!settings.secondary)
            settings.secondary = [];

        calculateGoldValue(singleBagLoad);
        calculatePaintingValue(singleBagLoad);
    }
}
/* set team size*/
function teamSizeChange(event)
{
    let playerTakeElements = document.querySelectorAll("#takeContainer .setupCategory.playerTake");
    let maxTeamSize = playerTakeElements.length;
    settings.teamSize = parseInt(event.target.value);

    for (var currentPlayer = 1; currentPlayer < maxTeamSize; currentPlayer++)
    {
        if (currentPlayer < settings.teamSize)
        {
            let currentPlayerElement = playerTakeElements[currentPlayer];
            currentPlayerElement.classList.remove("hidden");
            currentPlayerElement.querySelector(".playerCut").value = 15;
        }
        else
        {
            playerTakeElements[currentPlayer].classList.add("hidden");
        }
    }

    playerTakeElements[0].querySelector(".playerCut").value = 100 - ((settings.teamSize - 1) * 15);

    calculateTake();
}
document.querySelector("#teamsize input").addEventListener("input", teamSizeChange);

/* player take % */
function updatePlayerTake(event)
{
    let sum = 0;
    let sumOthers = 0;
    document.querySelectorAll("#takeContainer .setupCategory.playerTake:not(.hidden) input").forEach(function(input)
    {
        let value = parseInt(input.value);
        if (event.target != input)
            sumOthers += value;
        sum += value;
    });

    if (sum >= 100)
    {
        event.target.value = 100 - sumOthers;
    }

    calculateTake();
}
document.querySelectorAll("#takeContainer .setupCategory.playerTake input").forEach(function(input)
{
    input.addEventListener("input", updatePlayerTake);
});

/* team mate cut limit */
function formatCutLimit(element)
{
    let input = element.value.replace(/[\D\s\._\-]+/g, "");
    input = input ? parseInt(input, 10) : 0;
    element.value = input.toLocaleString();
    settings.cutLimit = input;
}
function updateCutLimit(event)
{
    formatCutLimit(event.target);
    calculateTake();
}
let cutLimit = document.querySelector("#cutLimit");
cutLimit.addEventListener("input", updateCutLimit);
cutLimit.value = cayo.defaultCutLimit;
formatCutLimit(cutLimit);

/* total take hard limit */
function formatTakeLimit(element)
{
    let input = element.value.replace(/[\D\s\._\-]+/g, "");
    input = input ? parseInt(input, 10) : 0;
    element.value = input.toLocaleString();
    settings.takeLimit = input;
}
function updateTakeLimit(event)
{
    formatCutLimit(event.target);
    calculateTake();
}
let takeLimit = document.querySelector("#takeLimit");
takeLimit.addEventListener("input", updateTakeLimit);
takeLimit.value = cayo.defaultTakeLimit;
formatTakeLimit(takeLimit);

/* select supply truck location */
function selectSupplyTruckLocation(event)
{
    let target = event.target;
    settings.supplyTruckLocation = parseInt(target.id.replace("truck", ""));

    if (target.classList.contains("truckOn")) //disable truck selection
    {
        delete settings.supplyTruckLocation;
        target.classList.remove("truckOn");
    }
    else
    {
        document.querySelectorAll(".truckIcon").forEach(function(truckElement)
        {
            truckElement.classList.remove("truckOn");
        });

        target.classList.add("truckOn");
    }
}
document.querySelectorAll(".truckIcon").forEach(function(truckElement)
{
    truckElement.addEventListener("click", selectSupplyTruckLocation);
});
</script>
</html>
